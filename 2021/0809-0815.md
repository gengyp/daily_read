# WPS
## 工作表中批量提取工作表名称
1. 公式 --> 名称管理器 --> 新建
2. 名称：`name` ；引用位置：`=get.workbook(1)`  --> 确定
3. 在新 sheet 的 A1 单元格输入：`=IFERROR(INDEX(name,ROW(A1)),"")`，然后下拉填充


# 建模流程优化（尽量保证每步可多次运行）
1. 确定业务需求：需要几个模型，分别用来干嘛，怎么建模
2. 数据处理(1_data_pro.ipynb)
    1. 若数据量很大-10G，则需要对样本进行按列分割保存成n份，每份均含label。从两个维度进行降维
        1. 变量个数，通过缺失、top1_rate、唯一值、异常值等对变量进行人工过滤
        2. 若正样本很少，则需要对负样本欠采样，然后在根据情况抽取 train-test 样本 和 validation 样本。
    2. 变量衍生：日期变量转天数，离散变量one-hot编码等，视具体数据集
    3. 特征处理
        1. 一般特征工程
            1. 将所有空值和没有意义的字符替换为 nan 值
            2. 缺失值填充：miss_value_dt = {变量名:[缺失类型，填充值]} 记录每个变量填充值；缺失类型有 unique<=12/距今天数(_days)/float-0/unknown
                1. 连续变量：唯一值<=10 的强制转换为离散变量（原本分类变量编码存储）num2cat_dt = {}，用 unknown 填充；距今天数可用最大值填充；其他次数、金额用0填充
                2. 离散变量：unknown 填充
            3. 离散变量编码：根据 bad_ratio 排序编码并替换原始数据集
        2. Woe特征工程
            1. 将所有空值和没有意义的字符替换为 nan 值
            2. 连续变量
                1. 唯一值<=10 的强制转换为离散变量（原本分类变量编码存储），用 unknown 填充；
                2. Top3>=0.95的连续变量，通过连续变量映射字典转换为
                3. 其他连续变量不填充(等分箱后填充)
            3. 离散变量：用 unknown 填充；
3. 建模
    1. 数据分割：train、test
    2. 树模型变量筛选：RandomForest、XGBoost、lightgbm 等均不选中变量删除，重新建模，交叉验证
    3. 可选：根据变量相关性、VIF 人工筛选变量
    4. 建模评估
        1. 针对每个模型（四个模型），输出模型变量个数，ks，auc，psi
            1. 输出模型变量个数
            2. acc、ks、psi、auc、混淆矩阵、评估图片
        2. 评分卡输出（csv、excel）
            1. 模型变量表 var_info
            2. 变量分箱得分表 var_bin_info
            3. 模型得分分层表 score_distr_info
            4. 得分分层ks、逾期率、正样本识别率、模型通过率
            5. 模型正负样本分布图、坏样本占比趋势图
    5. 模型预测
        1. 加载模型
        2. 数据处理
        3. 预测评估
4. 上线部署
    1. 模型文件
    2. 模型验证数据
    3. 白户生成单独标签或者 两个模型均拒绝的不通过